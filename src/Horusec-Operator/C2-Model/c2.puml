@startuml horusec-operator-c2
!include https://raw.githubusercontent.com/adrianvlupu/C4-PlantUML/latest/C4_Context.puml
!include https://raw.githubusercontent.com/adrianvlupu/C4-PlantUML/latest/C4_Component.puml
!include https://raw.githubusercontent.com/adrianvlupu/C4-PlantUML/latest/C4_Container.puml
!include https://raw.githubusercontent.com/adrianvlupu/C4-PlantUML/latest/C4_Deployment.puml
!include https://raw.githubusercontent.com/adrianvlupu/C4-PlantUML/latest/C4_Dynamic.puml

LAYOUT_WITH_LEGEND()

Person(user, "SRE/DevSecOps/DevOps", "Pessoa que queira instalar ou realizar a manutenção do Horusec-Platform em um cluster Kubernetes.")

System_Boundary(horusecOperator, "Horusec-Operator") {
  System(HorusecOperatorPhase0, "Usuário instala a CRD do Horusec em seu cluster.")
  System(HorusecOperatorPhase1, "Kubernetes informa ao horusec-operator que houve uma alteração externa nos recursos horusec.")
  System(HorusecOperatorPhase2, "Recebe a alteração e junta com os valores padrões esperado pelo horusec caso estejam vazios.")
  System(HorusecOperatorPhase3, "Verifica se houve alguma alteração a partir da entrada enviada do usuário.")
  System(HorusecOperatorPhase4, "Faz a junção dos novos dados com o que já existe na aplicação kubernetes, colhendo as informações do cluster que são necessárias criar, alterar, remover configurações e serviços.")
  System(HorusecOperatorPhase5, "Realiza aplicação das alterações no cluster kubernetes.")
}

System_Ext(Kubernetes, "Kubernetes", "Sistema de orquestração de contêineres")

Rel(user, HorusecOperatorPhase0, "")
Rel(HorusecOperatorPhase0, Kubernetes, "")
Rel(Kubernetes, HorusecOperatorPhase1, "")
Rel(HorusecOperatorPhase1, HorusecOperatorPhase2, "")
Rel(HorusecOperatorPhase2, HorusecOperatorPhase3, "")
Rel(HorusecOperatorPhase3, HorusecOperatorPhase4, "")
Rel(HorusecOperatorPhase4, HorusecOperatorPhase5, "")

@enduml
